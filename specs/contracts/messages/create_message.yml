description: メッセージ作成のコントラクト
name: create_message_contract
priority: 1

request:
  method: POST
  url: /api/messages
  headers:
    Content-Type: application/json
  body:
    code: "MSG_001"
    content: "Hello, Contract Testing!"
  matchers:
    body:
      - path: $.code
        type: by_regex
        value: "^[a-zA-Z0-9_-]+$"
      - path: $.content
        type: by_regex
        value: ".+"

response:
  status: 201
  headers:
    Content-Type: application/json
    Location: matches("^/api/messages/[0-9]+$")
  body:
    id: 1
    code: "MSG_001"
    content: "Hello, Contract Testing!"
    createdAt: "2024-01-01T00:00:00Z"
    updatedAt: "2024-01-01T00:00:00Z"
  matchers:
    body:
      - path: $.id
        type: by_type
      - path: $.code
        type: by_equality
      - path: $.content
        type: by_equality
      - path: $.createdAt
        type: by_regex
        value: "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}.*$"
      - path: $.updatedAt
        type: by_regex
        value: "^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}.*$"
